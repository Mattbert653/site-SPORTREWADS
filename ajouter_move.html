<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ajouter Move</title>
    <style>
        body {
            background-color: rgb(248, 190, 114); /* Couleur de fond de la page */
            margin: 0; /* Supprime les marges par d√©faut */
            font-family: Arial, sans-serif; /* Police */
            display: flex; /* Flexbox pour centrer le contenu */
            flex-direction: column; /* Aligne le contenu en colonne */
            align-items: center; /* Centre le contenu horizontalement */
            justify-content: center; /* Centre le contenu verticalement */
            height: 100vh; /* Prend toute la hauteur de la fen√™tre */
            color: white; /* Couleur du texte */
            text-align: center; /* Centre le texte */
            position: relative; /* Position relative pour centrer les √©l√©ments */
        }

        h1 {
            margin-bottom: 20px; /* Espace en bas du titre */
        }

        /* Styles pour le flux vid√©o */
        video {
            border: 2px solid white; /* Bordure autour de la vid√©o */
            margin-bottom: 20px; /* Espace en bas de la vid√©o */
            width: 100%; /* Prend toute la largeur */
            height: 100%; /* Prend toute la hauteur */
            position: absolute; /* Positionne la vid√©o */
            top: 0; /* Aligne en haut */
            left: 0; /* Aligne √† gauche */
            object-fit: cover; /* Recouvre l'espace */
            z-index: 1; /* Envoie la vid√©o en arri√®re-plan */
        }

        /* Styles pour les √©l√©ments au-dessus de la vid√©o */
        .overlay {
            position: relative; /* Position relative pour centrer les √©l√©ments */
            z-index: 2; /* Positionne les √©l√©ments au-dessus de la vid√©o */
        }

        /* Styles pour le bouton de capture de photo */
        .photo-upload {
            margin: 20px; /* Espace autour du bouton */
            width: 40px; /* Largeur du bouton */
            height: 40px; /* Hauteur du bouton */
            background-color: white; /* Couleur de fond du bouton */
            border: none; /* Supprime la bordure */
            border-radius: 50%; /* Arrondi le bouton */
            position: absolute; /* Positionne le bouton */
            bottom: 20px; /* Positionne le bouton en bas */
            left: 50%; /* Centre horizontalement */
            transform: translateX(-50%); /* Ajuste le centrage */
            cursor: pointer; /* Curseur de main sur survol */
            z-index: 2; /* Positionne le bouton au-dessus de la vid√©o */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); /* Ajoute une ombre pour donner du relief */
        }

        /* Styles pour la photo prise */
        .photo-display {
            margin: 20px; /* Espace autour de la photo */
            border: 2px solid white; /* Bordure autour de la photo */
            display: none; /* Masquer par d√©faut */
            max-width: 100%; /* Limite la largeur maximale */
            max-height: 80vh; /* Limite la hauteur maximale */
            position: relative; /* Positionne la photo au-dessus de la vid√©o */
            z-index: 2; /* Positionne la photo au-dessus de la vid√©o */
        }

        /* Styles pour le message de chargement */
        .loading {
            display: none; /* Masquer par d√©faut */
            font-size: 2em; /* Taille du texte */
            margin: 20px; /* Espace autour du message */
            position: relative; /* Positionne le message au-dessus de la vid√©o */
            z-index: 2; /* Positionne le message au-dessus de la vid√©o */
        }

        /* Styles pour le message de f√©licitations */
        .message {
            font-size: 2em; /* Taille du texte */
            margin-top: 20px; /* Espace au-dessus du message */
            visibility: hidden; /* Masquer le message au d√©part */
            position: relative; /* Positionne le message au-dessus de la vid√©o */
            z-index: 2; /* Positionne le message au-dessus de la vid√©o */
        }

        /* Styles pour la tirelire */
        .tirelire {
            font-size: 3em; /* Taille du texte de la tirelire */
            margin-top: 20px; /* Espace au-dessus de la tirelire */
            visibility: hidden; /* Masquer la tirelire au d√©part */
            position: relative; /* Positionne la tirelire au-dessus de la vid√©o */
            z-index: 2; /* Positionne la tirelire au-dessus de la vid√©o */
        }

        /* Styles pour les boutons de confirmation */
        .confirm-btn, .retry-btn, .back-btn {
            margin: 10px; /* Espace autour des boutons */
            padding: 10px 20px; /* Espace √† l'int√©rieur des boutons */
            background-color: #28a745; /* Couleur de fond pour le bouton de confirmation */
            border: none; /* Supprime la bordure */
            border-radius: 5px; /* Bords arrondis */
            color: white; /* Couleur du texte */
            font-size: 1.2em; /* Taille du texte */
            cursor: pointer; /* Curseur de main sur survol */
            transition: background-color 0.3s; /* Transition pour l'effet de survol */
            position: relative; /* Positionne les boutons au-dessus de la vid√©o */
            z-index: 2; /* Positionne les boutons au-dessus de la vid√©o */
        }

        .confirm-btn:hover, .back-btn:hover {
            background-color: #218838; /* Change la couleur au survol */
        }

        .retry-btn {
            background-color: #dc3545; /* Couleur de fond pour le bouton de reprise */
        }

        .retry-btn:hover {
            background-color: #c82333; /* Change la couleur au survol */
        }

        @media (max-width: 600px) {
            /* Styles pour les petits √©crans (smartphones) */
            .photo-upload {
                width: 80%; /* Largeur du bouton sur mobile */
                height: 80%; /* Hauteur du bouton sur mobile */
                font-size: 1em; /* Taille du texte sur mobile */
            }

            video {
                max-height: 100%; /* Limite la hauteur de la vid√©o sur mobile */
            }
        }
    </style>
</head>

<body>
    <video id="video" autoplay></video>
    <div class="overlay">
        <h1>D√©posez votre Move</h1>
        <button class="photo-upload" id="capture-btn"></button> <!-- Bouton circulaire sans texte -->

        <canvas id="canvas" style="display: none;"></canvas>
        <img id="photo-display" class="photo-display" alt="Photo captur√©e">

        <!-- Message de chargement -->
        <div class="loading" id="loading">Chargement...</div>

        <!-- Message de f√©licitations -->
        <div class="message" id="message">Bravo ! √Ä demain !</div>
        <div class="tirelire" id="tirelire">üí∞ 20 points</div>

        <!-- Modal de confirmation -->
        <div id="confirmation-modal" style="display: none;">
            <h2>Confirmez votre photo</h2>
            <button class="confirm-btn" id="confirm-btn">Confirmer</button>
            <button class="retry-btn" id="retry-btn">Reprendre</button>
        </div>

        <!-- Bouton de retour au menu -->
        <button class="back-btn" id="back-btn" style="display: none;">Retour au menu</button>
    </div>

    <script>
        const video = document.getElementById('video');
        const captureButton = document.getElementById('capture-btn');
        const loadingMessage = document.getElementById('loading');
        const message = document.getElementById('message');
        const tirelire = document.getElementById('tirelire');
        const photoDisplay = document.getElementById('photo-display');
        const confirmationModal = document.getElementById('confirmation-modal');
        const confirmButton = document.getElementById('confirm-btn');
        const retryButton = document.getElementById('retry-btn');
        const backButton = document.getElementById('back-btn');

        // Acc√®s √† la cam√©ra
        navigator.mediaDevices.getUserMedia({ video: true })
            .then((stream) => {
                video.srcObject = stream;
            })
            .catch((error) => {
                console.error("Erreur d'acc√®s √† la cam√©ra:", error);
            });

        captureButton.addEventListener('click', () => {
            const canvas = document.getElementById('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const context = canvas.getContext('2d');
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            const dataURL = canvas.toDataURL('image/png');
            photoDisplay.src = dataURL;
            photoDisplay.style.display = 'block';

            // Masquer le flux vid√©o
            video.style.display = 'none';
            captureButton.style.display = 'none';
            confirmationModal.style.display = 'block';
        });

        confirmButton.addEventListener('click', () => {
            loadingMessage.style.display = 'block';
            confirmationModal.style.display = 'none';
            message.style.visibility = 'visible';
            tirelire.style.visibility = 'visible';
            loadingMessage.style.display = 'none';

            // Simule l'ajout de points √† la tirelire
            setTimeout(() => {
                message.innerText = "Bravo ! Votre photo a √©t√© ajout√©e.";
                backButton.style.display = 'block'; // Affiche le bouton de retour
            }, 2000);
        });

        retryButton.addEventListener('click', () => {
            photoDisplay.style.display = 'none';
            video.style.display = 'block'; // Affiche √† nouveau le flux vid√©o
            captureButton.style.display = 'block'; // Affiche √† nouveau le bouton
            confirmationModal.style.display = 'none';
        });

        backButton.addEventListener('click', () => {
            window.location.href = "index.html"; // Redirige vers l'index
        });
    </script>
</body>
</html>
