<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">  <!-- Convention pour les accents -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ajouter Move</title>  <!-- Titre -->
    <style>
        body {
            background-color: rgb(248, 190, 114);  /* Couleur de fond de la page */
            margin: 0;  /* Supprime les marges par d√©faut */
            font-family: Arial, sans-serif;  /* Police */
            display: flex;  /* Flexbox pour centrer le contenu */
            flex-direction: column;  /* Aligne le contenu en colonne */
            align-items: center;  /* Centre le contenu horizontalement */
            justify-content: center;  /* Centre le contenu verticalement */
            height: 100vh;  /* Prend toute la hauteur de la fen√™tre */
            color: white;  /* Couleur du texte */
            text-align: center;  /* Centre le texte */
        }

        h1 {
            margin-bottom: 20px;  /* Espace en bas du titre */
        }

        /* Styles pour le bouton de capture de photo */
        .photo-upload {
            margin: 20px;  /* Espace autour du bouton */
            padding: 15px 25px;  /* Espace √† l'int√©rieur du bouton */
            background-color: #ff6f00;  /* Couleur de fond du bouton */
            border: none;  /* Supprime la bordure */
            border-radius: 5px;  /* Bords arrondis */
            color: white;  /* Couleur du texte */
            font-size: 1.2em;  /* Taille du texte */
            cursor: pointer;  /* Curseur de main sur survol */
            transition: background-color 0.3s;  /* Transition pour l'effet de survol */
        }

        .photo-upload:hover {
            background-color: #ff8f00;  /* Change la couleur au survol */
        }

        /* Styles pour le flux vid√©o */
        video {
            border: 2px solid white;  /* Bordure autour de la vid√©o */
            margin-bottom: 20px;  /* Espace en bas de la vid√©o */
            width: 100%;  /* Prend toute la largeur */
            max-width: 400px;  /* Largeur maximale de la vid√©o */
        }

        /* Styles pour la photo prise */
        .photo-display {
            margin: 20px;  /* Espace autour de la photo */
            border: 2px solid white;  /* Bordure autour de la photo */
            display: none;  /* Masquer par d√©faut */
        }

        /* Styles pour le message de chargement */
        .loading {
            display: none;  /* Masquer par d√©faut */
            font-size: 2em;  /* Taille du texte */
            margin: 20px;  /* Espace autour du message */
        }

        /* Styles pour le message de f√©licitations */
        .message {
            font-size: 2em;  /* Taille du texte */
            margin-top: 20px;  /* Espace au-dessus du message */
            visibility: hidden;  /* Masquer le message au d√©part */
        }

        /* Styles pour la tirelire */
        .tirelire {
            font-size: 3em;  /* Taille du texte de la tirelire */
            margin-top: 20px;  /* Espace au-dessus de la tirelire */
            visibility: hidden;  /* Masquer la tirelire au d√©part */
        }

        /* Styles pour les boutons de confirmation */
        .confirm-btn, .retry-btn {
            margin: 10px;  /* Espace autour des boutons */
            padding: 10px 20px;  /* Espace √† l'int√©rieur des boutons */
            background-color: #28a745;  /* Couleur de fond pour le bouton de confirmation */
            border: none;  /* Supprime la bordure */
            border-radius: 5px;  /* Bords arrondis */
            color: white;  /* Couleur du texte */
            font-size: 1.2em;  /* Taille du texte */
            cursor: pointer;  /* Curseur de main sur survol */
            transition: background-color 0.3s;  /* Transition pour l'effet de survol */
        }

        .confirm-btn:hover {
            background-color: #218838;  /* Change la couleur au survol */
        }

        .retry-btn {
            background-color: #dc3545;  /* Couleur de fond pour le bouton de reprise */
        }

        .retry-btn:hover {
            background-color: #c82333;  /* Change la couleur au survol */
        }
    </style>
</head>

<body>
    <h1>D√©posez votre Move</h1>
    
    <video id="video" autoplay></video>
    <button class="photo-upload" id="capture-btn">Capturer la photo</button>
    
    <canvas id="canvas" style="display: none;"></canvas>
    <img id="photo-display" class="photo-display" alt="Photo captur√©e">

    <!-- Message de chargement -->
    <div class="loading" id="loading">Chargement...</div>

    <!-- Message de f√©licitations -->
    <div class="message" id="message">Bravo ! √Ä demain !</div>
    <div class="tirelire" id="tirelire">üí∞ 20 points</div>

    <!-- Modal de confirmation -->
    <div id="confirmation-modal" style="display: none;">
        <h2>Confirmez votre photo</h2>
        <button class="confirm-btn" id="confirm-btn">Confirmer</button>
        <button class="retry-btn" id="retry-btn">Reprendre</button>
    </div>

    <script>
        const video = document.getElementById('video');
        const captureButton = document.getElementById('capture-btn');
        const loadingMessage = document.getElementById('loading');
        const message = document.getElementById('message');
        const tirelire = document.getElementById('tirelire');
        const canvas = document.getElementById('canvas');
        const photoDisplay = document.getElementById('photo-display');

        const confirmationModal = document.getElementById('confirmation-modal');
        const confirmButton = document.getElementById('confirm-btn');
        const retryButton = document.getElementById('retry-btn');

        // Demander l'acc√®s √† la cam√©ra
        navigator.mediaDevices.getUserMedia({ video: true })
            .then((stream) => {
                video.srcObject = stream; // Affiche le flux vid√©o sur la balise video
            })
            .catch((error) => {
                console.error('Erreur d\'acc√®s √† la cam√©ra : ', error);
            });

        // Fonction pour capturer la photo
        captureButton.addEventListener('click', () => {
            // D√©finir la taille du canvas selon le flux vid√©o
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0); // Dessine l'image du flux vid√©o sur le canvas
            
            // Affiche la photo captur√©e
            photoDisplay.src = canvas.toDataURL(); // Convertit le canvas en image
            photoDisplay.style.display = 'block'; // Affiche la photo
            
            // Affiche le modal de confirmation
            confirmationModal.style.display = 'flex';
            confirmationModal.style.flexDirection = 'column';
            confirmationModal.style.alignItems = 'center';
            confirmationModal.style.justifyContent = 'center';
            confirmationModal.style.color = 'white';
            confirmationModal.style.marginTop = '20px';
            
            // Masquer le flux vid√©o et le bouton de capture
            video.style.display = 'none';
            captureButton.style.display = 'none';
        });

        // Fonction pour confirmer l'envoi
        confirmButton.addEventListener('click', () => {
            // Masquer le modal
            confirmationModal.style.display = 'none';
            // Afficher le message de chargement
            loadingMessage.style.display = 'block';

            // Animation de chargement
            setTimeout(() => {
                loadingMessage.style.display = 'none'; // Masquer le message de chargement
                photoDisplay.style.display = 'none'; // Masquer la photo
                message.style.visibility = 'visible'; // Afficher le message
                tirelire.style.visibility = 'visible'; // Afficher la tirelire
            }, 3000); // Dur√©e du chargement
        });

        // Fonction pour reprendre la photo
        retryButton.addEventListener('click', () => {
            // Masquer le modal
            confirmationModal.style.display = 'none';
            // R√©afficher le flux vid√©o et le bouton
            video.style.display = 'block';
            captureButton.style.display = 'block';
            // Masquer la photo captur√©e
            photoDisplay.style.display = 'none';
        });
    </script>
</body>
</html>
